import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css                        */import"./main-n1Spxp1A.js";const s="https://ethinest.onrender.com/api",l=localStorage.getItem("activeProperty");let t=null,i=!1;document.addEventListener("DOMContentLoaded",async()=>{const n=Swal.fire({title:"Loading property details...",allowOutsideClick:!1,didOpen:()=>Swal.showLoading()});try{const e=JSON.parse(localStorage.getItem("activeUser"));if(e){const o=await fetch(`${s}/checkfavorites?prop_id=${l}&user_id=${e.id}`);o.ok&&(i=(await o.json()).success)}m(i);const r=await fetch(`${s}/getPropertyDetail?propId=${l}`);if(!r.ok)throw new Error("Failed to load property details");t=await r.json(),document.getElementById("mainImage").src=t[2][0].image_path,document.getElementById("property_title").textContent=t[0].title,document.getElementById("property_price").textContent=`${parseFloat(t[0].price).toLocaleString("en-US")} ETB`,document.getElementById("bedroom").textContent=t[0].bedrooms,document.getElementById("bathroom").textContent=t[0].bathrooms,document.getElementById("area").textContent=t[0].area,document.getElementById("type").textContent=t[0].type,document.getElementById("description").textContent=t[0].description,document.getElementById("property_address").textContent="Hawassa "+t[0].address+", Sidama Region",document.getElementById("ownerName").textContent=t[1].name,document.getElementById("owner_phone").innerHTML+=t[1].phone,document.getElementById("owner_email").innerHTML+=t[1].email,document.getElementById("ownerImage").src="/images/"+t[1].profile_picture;const a=document.getElementById("thumbnailContainer");a.innerHTML="",t[2].forEach(o=>{a.innerHTML+=`
            <img src=${o.image_path}
            alt=${t[0].title} 
            class="thumbnail"
            >`}),document.querySelectorAll(".thumbnail").forEach(o=>{o.addEventListener("click",function(){f(this)})})}catch(e){await Swal.fire({icon:"error",title:"Error",text:e.message||"Failed to load property details"}),document.getElementById("propertyContainer").innerHTML=`
            <div class="error-message">
                <i class="fas fa-exclamation-circle"></i>
                <p>${e.message||"Failed to load property details"}</p>
                <button class="btn-primary" onclick="window.history.back()">Go Back</button>
            </div>
        `}finally{n.close()}});function m(n){const e=document.getElementById("saveProperty");if(!e)return;const r=e.querySelector("i")||document.createElement("i");n?(r.className="fas fa-heart",e.innerHTML='<i class="fas fa-heart"></i> Saved',e.classList.add("saved")):(r.className="far fa-heart",e.innerHTML='<i class="far fa-heart"></i> Save',e.classList.remove("saved"))}function f(n){const e=document.getElementById("mainImage");e.src=n.src,e.alt=n.alt}const u=document.getElementById("saveProperty");u&&u.addEventListener("click",async function(){const n=JSON.parse(localStorage.getItem("activeUser"));if(!n){(await Swal.fire({title:"Login Required",text:"You need to login to save properties",icon:"warning",showCancelButton:!0,confirmButtonText:"Login",cancelButtonText:"Cancel"})).isConfirmed&&(window.location.href="./login.html");return}const e=this,r=e.innerHTML;e.innerHTML='<i class="fas fa-spinner fa-spin"></i> Processing...',e.disabled=!0;try{let a;if(i)if(a=await fetch(`${s}/unsavefromfavorite?prop_id=${l}&user_id=${n.id}`),a.ok)i=!1,m(!1),await Swal.fire({icon:"success",title:"Removed!",text:"Property removed from favorites",toast:!0,position:"center",showConfirmButton:!1,timer:2e3});else{const o=await a.json();throw new Error(o.error||"Failed to unsave property")}else if(a=await fetch(`${s}/addtofavorite`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prop_id:l,user_id:n.id,tenant_name:`${n.firstname} ${n.lastname}`,owner_id:t[1].id,title:t[0].title})}),a.ok)i=!0,m(!0),await Swal.fire({icon:"success",title:"Saved!",text:"Property added to favorites",toast:!0,position:"center",showConfirmButton:!1,timer:2e3});else{const o=await a.json();throw new Error(o.error||"Failed to save property")}}catch(a){await Swal.fire({icon:"error",title:"Error",text:a.message})}finally{e.innerHTML=r,e.disabled=!1}});const c=document.getElementById("contactForm");c&&c.addEventListener("submit",async n=>{n.preventDefault();const e=JSON.parse(localStorage.getItem("activeUser"));if(!e){await Swal.fire({title:"Login Required",text:"You need to login to contact the owner",icon:"warning",showCancelButton:!0,confirmButtonText:"Login",cancelButtonText:"Cancel"}).then(o=>{o.isConfirmed&&(window.location.href="./login.html")});return}const r=c.querySelector('button[type="submit"]'),a=r.innerHTML;r.innerHTML='<i class="fas fa-spinner fa-spin"></i> Sending...',r.disabled=!0;try{const o={tenantId:e.id,ownerId:t[1].id,propertyId:t[0].id,message:`${document.getElementById("contactMessage").value}

Email: ${document.getElementById("contactEmail").value}
Phone: ${document.getElementById("contactPhone").value}
Name: ${document.getElementById("contactName").value}`},d=await fetch(`${s}/inquiries`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(d.ok)await Swal.fire({icon:"success",title:"Sent!",text:"Your message has been sent to the property owner",showConfirmButton:!1,timer:2e3}),c.reset();else{const p=await d.json();throw new Error(p.message||"Failed to send message")}}catch(o){await Swal.fire({icon:"error",title:"Error",text:o.message})}finally{r.innerHTML=a,r.disabled=!1}});document.addEventListener("DOMContentLoaded",function(){const n=document.getElementById("mainImage");n&&n.addEventListener("click",function(){console.log("Open image gallery")})});
